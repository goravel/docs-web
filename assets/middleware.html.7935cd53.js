import{_ as p,r as o,o as c,c as i,b as n,d as t,w as e,e as s,f as u}from"./app.1c33e199.js";const l={},r=n("h1",{id:"http-\u4E2D\u95F4\u4EF6",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#http-\u4E2D\u95F4\u4EF6","aria-hidden":"true"},"#"),s(" HTTP \u4E2D\u95F4\u4EF6")],-1),d={class:"table-of-contents"},k=s("\u4ECB\u7ECD"),v=s("\u5B9A\u4E49\u4E2D\u95F4\u4EF6"),m=s("\u6CE8\u518C\u4E2D\u95F4\u4EF6"),h=s("\u5168\u5C40\u4E2D\u95F4\u4EF6"),b=s("\u4E3A\u8DEF\u7531\u5206\u914D\u4E2D\u95F4\u4EF6"),g=u(`<h2 id="\u4ECB\u7ECD" tabindex="-1"><a class="header-anchor" href="#\u4ECB\u7ECD" aria-hidden="true">#</a> \u4ECB\u7ECD</h2><p>\u4E2D\u95F4\u4EF6\u53EF\u4EE5\u8FC7\u6EE4\u8FDB\u5165\u5E94\u7528\u7A0B\u5E8F\u7684 HTTP \u8BF7\u6C42\u3002\u4F8B\u5982 <code>Goravel</code> \u63D0\u4F9B\u4E00\u4E2A CORS \u4E2D\u95F4\u4EF6\uFF0C\u53EF\u4EE5\u5B9E\u73B0\u8BF7\u6C42\u8DE8\u57DF\u3002</p><h2 id="\u5B9A\u4E49\u4E2D\u95F4\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u5B9A\u4E49\u4E2D\u95F4\u4EF6" aria-hidden="true">#</a> \u5B9A\u4E49\u4E2D\u95F4\u4EF6</h2><p>\u4F60\u53EF\u4EE5\u5728 <code>app/http/middleware</code> \u76EE\u5F55\u4E2D\u521B\u5EFA\u81EA\u5DF1\u7684\u4E2D\u95F4\u4EF6\uFF0C\u7ED3\u6784\u5982\u4E0B\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> middleware

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;github.com/goravel/framework/contracts/http&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">Cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span> http<span class="token punctuation">.</span>Middleware <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx http<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		method <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Method</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		origin <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Header</span><span class="token punctuation">(</span><span class="token string">&quot;Origin&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> origin <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
			ctx<span class="token punctuation">.</span><span class="token function">Response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Origin&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span>
			ctx<span class="token punctuation">.</span><span class="token function">Response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Methods&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;POST, GET, OPTIONS, PUT, DELETE, UPDATE&quot;</span><span class="token punctuation">)</span>
			ctx<span class="token punctuation">.</span><span class="token function">Response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Headers&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span>
			ctx<span class="token punctuation">.</span><span class="token function">Response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Expose-Headers&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Content-Length, Access-Control-Allow-Origin, Access-Control-Allow-Headers, Authorization&quot;</span><span class="token punctuation">)</span>
			ctx<span class="token punctuation">.</span><span class="token function">Response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Max-Age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;172800&quot;</span><span class="token punctuation">)</span>
			ctx<span class="token punctuation">.</span><span class="token function">Response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Credentials&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span> method <span class="token operator">==</span> <span class="token string">&quot;OPTIONS&quot;</span> <span class="token punctuation">{</span>
			ctx<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">AbortWithStatus</span><span class="token punctuation">(</span><span class="token number">204</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>

		ctx<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Goravel \u4E2D\u81EA\u5E26\u4E86\u4E00\u4E9B\u4E2D\u95F4\u4EF6\u53EF\u4F9B\u4F7F\u7528\uFF1A</p><table><thead><tr><th>\u4E2D\u95F4\u4EF6</th><th>\u4F5C\u7528</th></tr></thead><tbody><tr><td>github.com/goravel/framework/http/middleware/Cors</td><td>\u5B9E\u73B0\u8DE8\u57DF</td></tr></tbody></table><h2 id="\u6CE8\u518C\u4E2D\u95F4\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u6CE8\u518C\u4E2D\u95F4\u4EF6" aria-hidden="true">#</a> \u6CE8\u518C\u4E2D\u95F4\u4EF6</h2><h3 id="\u5168\u5C40\u4E2D\u95F4\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u5168\u5C40\u4E2D\u95F4\u4EF6" aria-hidden="true">#</a> \u5168\u5C40\u4E2D\u95F4\u4EF6</h3><p>\u5982\u679C\u4F60\u5E0C\u671B\u5728\u5E94\u7528\u7A0B\u5E8F\u7684\u6BCF\u4E00\u4E2A HTTP \u8BF7\u6C42\u5E94\u7528\u4E2D\u95F4\u4EF6\uFF0C\u90A3\u4E48\u53EA\u9700\u8981\u5728 <code>app/http/kernel.go</code> \u6587\u4EF6\u4E2D\u7684 <code>Middleware</code> \u6CE8\u518C\u4E2D\u95F4\u4EF6\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// app/http/kernel.go</span>
<span class="token keyword">package</span> http

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;github.com/goravel/framework/contracts/http&quot;</span>
	<span class="token string">&quot;github.com/goravel/framework/http/middleware&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Kernel <span class="token keyword">struct</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>kernel <span class="token operator">*</span>Kernel<span class="token punctuation">)</span> <span class="token function">Middleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>http<span class="token punctuation">.</span>Middleware <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>http<span class="token punctuation">.</span>Middleware<span class="token punctuation">{</span>
		middleware<span class="token punctuation">.</span><span class="token function">Cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u4E3A\u8DEF\u7531\u5206\u914D\u4E2D\u95F4\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u4E3A\u8DEF\u7531\u5206\u914D\u4E2D\u95F4\u4EF6" aria-hidden="true">#</a> \u4E3A\u8DEF\u7531\u5206\u914D\u4E2D\u95F4\u4EF6</h3><p>\u4F60\u53EF\u4EE5\u4E3A\u67D0\u4E00\u4E9B\u8DEF\u7531\u5355\u72EC\u6CE8\u518C\u4E2D\u95F4\u4EF6\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token string">&quot;github.com/goravel/framework/http/middleware&quot;</span>

facades<span class="token punctuation">.</span>Route<span class="token punctuation">.</span><span class="token function">Middleware</span><span class="token punctuation">(</span>middleware<span class="token punctuation">.</span><span class="token function">Cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;users&quot;</span><span class="token punctuation">,</span> userController<span class="token punctuation">.</span>Show<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,14);function f(q,w){const a=o("router-link");return c(),i("div",null,[r,n("nav",d,[n("ul",null,[n("li",null,[t(a,{to:"#\u4ECB\u7ECD"},{default:e(()=>[k]),_:1})]),n("li",null,[t(a,{to:"#\u5B9A\u4E49\u4E2D\u95F4\u4EF6"},{default:e(()=>[v]),_:1})]),n("li",null,[t(a,{to:"#\u6CE8\u518C\u4E2D\u95F4\u4EF6"},{default:e(()=>[m]),_:1}),n("ul",null,[n("li",null,[t(a,{to:"#\u5168\u5C40\u4E2D\u95F4\u4EF6"},{default:e(()=>[h]),_:1})]),n("li",null,[t(a,{to:"#\u4E3A\u8DEF\u7531\u5206\u914D\u4E2D\u95F4\u4EF6"},{default:e(()=>[b]),_:1})])])])])]),g])}const x=p(l,[["render",f],["__file","middleware.html.vue"]]);export{x as default};
