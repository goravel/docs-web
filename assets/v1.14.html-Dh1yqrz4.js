import{_ as p,c as o,a as t,b as n,e as l,f as i,d as a,r,o as c}from"./app-B8FHsz6d.js";const d={};function u(v,s){const e=r("RouteLink");return c(),o("div",null,[s[23]||(s[23]=t(`<h1 id="从-v1-13-升级到-v1-14" tabindex="-1"><a class="header-anchor" href="#从-v1-13-升级到-v1-14"><span>从 v1.13 升级到 v1.14</span></a></h1><h3 id="令人兴奋的新功能-🎉" tabindex="-1"><a class="header-anchor" href="#令人兴奋的新功能-🎉"><span>令人兴奋的新功能 🎉</span></a></h3><ul><li><a href="#%E6%9C%AC%E5%9C%B0%E5%8C%96">本地化</a></li><li><a href="#%E5%AE%89%E8%A3%85%E5%99%A8">安装器</a></li><li><a href="#cookie">Cookie</a></li><li><a href="#session">Session</a></li></ul><h3 id="功能增强-🚀" tabindex="-1"><a class="header-anchor" href="#功能增强-🚀"><span>功能增强 🚀</span></a></h3><ul><li><a href="#gin-%E5%92%8C-fiber-%E9%A9%B1%E5%8A%A8%E6%94%AF%E6%8C%81%E8%AE%BE%E7%BD%AE-body-limit-%E5%92%8C-header-limit">gin 和 fiber 驱动支持设置 body_limit 和 header_limit</a></li><li><a href="#log-%E6%96%B0%E5%A2%9E%E6%96%B9%E6%B3%95">Log 新增方法</a></li><li><a href="#orm-%E6%96%B0%E5%A2%9E%E6%96%B9%E6%B3%95">Orm 新增方法</a></li><li><a href="#console-%E6%96%B0%E5%A2%9E%E6%96%B9%E6%B3%95">Console 新增方法</a></li><li><a href="#response-%E6%96%B0%E5%A2%9E%E6%96%B9%E6%B3%95">Response 新增方法</a></li><li><a href="#%E6%96%B0%E5%A2%9E-build-%E5%91%BD%E4%BB%A4">新增 Build 命令</a></li><li><a href="#%E6%96%B0%E5%A2%9E-helper-%E6%96%B9%E6%B3%95">新增 helper 方法</a></li><li><a href="#redis-%E9%A9%B1%E5%8A%A8%E6%94%AF%E6%8C%81%E8%AE%BE%E7%BD%AE-tls">Redis 驱动支持设置 TLS</a></li></ul><h3 id="破坏性变化-🛠" tabindex="-1"><a class="header-anchor" href="#破坏性变化-🛠"><span>破坏性变化 🛠</span></a></h3><ul><li><a href="#validation-%E5%A6%82%E6%9E%9C%E9%AA%8C%E8%AF%81%E5%A4%B1%E8%B4%A5%E5%B0%86%E4%B8%8D%E7%BB%91%E5%AE%9A%E6%95%B0%E6%8D%AE">Validation 如果验证失败将不绑定数据</a></li><li><a href="#testing-%E6%A8%A1%E5%9D%97%E6%96%B0%E5%A2%9E%E3%80%81%E4%BF%AE%E6%94%B9%E6%96%B9%E6%B3%95">Testing 模块新增、修改方法</a></li><li><a href="#%E4%BC%98%E5%8C%96-mail-%E6%A8%A1%E5%9D%97%E7%9A%84-queue-%E6%96%B9%E6%B3%95">优化 Mail 模块的 Queue 方法</a></li><li><a href="#%E4%BC%98%E5%8C%96-auth-%E6%A8%A1%E5%9D%97-ctx-%E7%9A%84%E8%AE%BE%E7%BD%AE%E6%96%B9%E6%B3%95">优化 Auth 模块 ctx 的设置方法</a></li><li><a href="#%E4%BC%98%E5%8C%96-mock-facades-%E7%9A%84%E6%96%B9%E5%BC%8F">优化 mock facades 的方式</a></li><li><a href="#%E6%A1%86%E6%9E%B6-orm-model-%E6%96%B0%E5%A2%9E-json-tag">框架 Orm model 新增 json tag</a></li></ul><h3 id="v1-14-1" tabindex="-1"><a class="header-anchor" href="#v1-14-1"><span>v1.14.1</span></a></h3><ul><li><a href="#%E4%BF%AE%E5%A4%8D-session-%E5%9C%A8-gin-%E9%A9%B1%E5%8A%A8%E4%B8%AD%E8%AE%BE%E7%BD%AE%E4%B8%8D%E6%88%90%E5%8A%9F%E7%9A%84%E9%97%AE%E9%A2%98">修复 session 在 gin 驱动中设置不成功的问题</a></li><li><a href="#%E4%BF%AE%E5%A4%8D%E6%9C%AC%E5%9C%B0%E5%8C%96%E6%A8%A1%E5%9D%97%E4%B8%AD%E8%AF%AD%E8%A8%80%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E9%94%99%E8%AF%AF%E7%9A%84%E9%97%AE%E9%A2%98">修复本地化模块中语言文件读取错误的问题</a></li></ul><h3 id="v1-14-2" tabindex="-1"><a class="header-anchor" href="#v1-14-2"><span>v1.14.2</span></a></h3><ul><li><a href="#%E4%BF%AE%E5%A4%8D-validation-%E9%AA%8C%E8%AF%81-image-%E4%B8%8E-file-%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%97%AE%E9%A2%98">修复 Validation 验证 image 与 file 失败的问题</a></li><li><a href="#%E4%BF%AE%E5%A4%8D-goravel-gin-%E9%A9%B1%E5%8A%A8%E8%AE%BE%E7%BD%AE-cookie-expires-%E6%97%A0%E6%95%88%E7%9A%84%E9%97%AE%E9%A2%98">修复 goravel/gin 驱动设置 cookie Expires 无效的问题</a></li></ul><h3 id="v1-14-3" tabindex="-1"><a class="header-anchor" href="#v1-14-3"><span>v1.14.3</span></a></h3><p>同时升级：goravel/gin: v1.2.2, goravel/fiber: v1.2.2</p><ul><li><a href="#%E4%BF%AE%E5%A4%8D-validation-%E6%97%A0%E6%B3%95%E7%BB%91%E5%AE%9A-slice-%E7%9A%84%E9%97%AE%E9%A2%98">修复 Validation 无法绑定 slice 的问题</a></li><li><a href="#validation-%E6%94%AF%E6%8C%81%E7%BB%91%E5%AE%9A-carbon">Validation 支持绑定 carbon</a></li></ul><h3 id="v1-14-4" tabindex="-1"><a class="header-anchor" href="#v1-14-4"><span>v1.14.4</span></a></h3><p>同时升级：goravel/gin: v1.2.3</p><ul><li><a href="#%E4%BF%AE%E5%A4%8D-session-%E5%B9%B6%E5%8F%91%E9%97%AE%E9%A2%98">修复 Session 并发问题</a></li><li><a href="#%E4%BF%AE%E5%A4%8D-gin-%E8%AE%BE%E7%BD%AE-session-same_site-%E6%97%A0%E6%95%88%E7%9A%84%E9%97%AE%E9%A2%98">修复 Gin 设置 Session same_site 无效的问题</a></li></ul><h3 id="v1-14-5" tabindex="-1"><a class="header-anchor" href="#v1-14-5"><span>v1.14.5</span></a></h3><p>同时升级：goravel/gin: v1.2.4, goravel/fiber: v1.2.3</p><ul><li><a href="#route-%E6%96%B0%E5%A2%9E-shutdown-%E6%96%B9%E6%B3%95">Route 新增 Shutdown 方法</a></li></ul><h3 id="v1-14-7" tabindex="-1"><a class="header-anchor" href="#v1-14-7"><span>v1.14.7</span></a></h3><p>同时升级：goravel/gin: v1.2.5, goravel/fiber: v1.2.4</p><ul><li><a href="#%E4%BC%98%E5%8C%96-http-%E7%9A%84-ctx-withvalue-%E6%96%B9%E6%B3%95">优化 HTTP 的 ctx.WithValue 方法</a></li></ul><h3 id="v1-14-8" tabindex="-1"><a class="header-anchor" href="#v1-14-8"><span>v1.14.8</span></a></h3><ul><li><a href="#%E4%BF%AE%E5%A4%8D%E6%B3%A8%E5%86%8C-listener-%E5%86%B2%E7%AA%81%E7%9A%84%E9%97%AE%E9%A2%98">修复注册 listener 冲突的问题</a></li></ul><h3 id="v1-14-9" tabindex="-1"><a class="header-anchor" href="#v1-14-9"><span>v1.14.9</span></a></h3><ul><li><a href="#%E4%BF%AE%E5%A4%8D%E8%87%AA%E5%AE%9A%E4%B9%89-log-%E9%A9%B1%E5%8A%A8%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%87%8D%E5%A4%8D%E6%89%93%E5%8D%B0%E7%9A%84%E9%97%AE%E9%A2%98">修复自定义 Log 驱动控制台重复打印的问题</a></li><li><a href="#%E4%BF%AE%E5%A4%8D-http-json-request-%E5%8C%85%E5%90%AB%E5%A4%9A%E5%B1%82%E7%BB%93%E6%9E%84%E6%97%B6%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E9%94%99%E8%AF%AF%E7%9A%84%E9%97%AE%E9%A2%98">修复 HTTP JSON Request 包含多层结构时数据绑定错误的问题</a></li></ul><h2 id="升级指南" tabindex="-1"><a class="header-anchor" href="#升级指南"><span>升级指南</span></a></h2><p>Goravel v1.14 基于 Golang 1.21 进行开发与测试，与其他低 Golang 版本一般情况下可以兼容运行。请根据本节内容，一步步进行框架升级。</p><p><strong>预计升级时间：10 分钟</strong></p><h3 id="_1-更新依赖" tabindex="-1"><a class="header-anchor" href="#_1-更新依赖"><span>1. 更新依赖</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">go get -u github.com/goravel/framework@v1.14.7</span>
<span class="line"></span>
<span class="line">// 如果使用 gin</span>
<span class="line">go get -u github.com/goravel/gin@v1.2.5</span>
<span class="line"></span>
<span class="line">// 如果使用 fiber</span>
<span class="line">go get -u github.com/goravel/fiber@v1.2.4</span>
<span class="line"></span>
<span class="line">// 如果使用 redis</span>
<span class="line">go get -u github.com/goravel/redis@v1.2.1</span>
<span class="line"></span>
<span class="line">// 如果使用 s3</span>
<span class="line">go get -u github.com/goravel/s3@v1.2.0</span>
<span class="line"></span>
<span class="line">// 如果使用 oss</span>
<span class="line">go get -u github.com/goravel/oss@v1.2.0</span>
<span class="line"></span>
<span class="line">// 如果使用 cos</span>
<span class="line">go get -u github.com/goravel/cos@v1.2.0</span>
<span class="line"></span>
<span class="line">// 如果使用 minio</span>
<span class="line">go get -u github.com/goravel/minio@v1.2.0</span>
<span class="line"></span>
<span class="line">// 如果使用 cloudinay</span>
<span class="line">go get -u github.com/goravel/cloudinary@v1.2.0</span>
<span class="line"></span>
<span class="line">go mod tidy</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-新增配置项" tabindex="-1"><a class="header-anchor" href="#_2-新增配置项"><span>2. 新增配置项</span></a></h3><ol><li><code>config/app.go</code> 新增本地化模块配置项：</li></ol><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token string">&quot;locale&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;en&quot;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token string">&quot;fallback_locale&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;en&quot;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token string">&quot;providers&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>foundation<span class="token punctuation">.</span>ServiceProvider<span class="token punctuation">{</span></span>
<span class="line">  <span class="token operator">...</span></span>
<span class="line">  <span class="token operator">&amp;</span>session<span class="token punctuation">.</span>ServiceProvider<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token operator">&amp;</span>translation<span class="token punctuation">.</span>ServiceProvider<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token operator">...</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>如果需要使用 <code>session</code> 功能，新增 <a href="https://github.com/goravel/goravel/blob/master/config/session.go" target="_blank" rel="noopener noreferrer">config/session.go</a> 文件；</li></ol><h3 id="_3-如果正在使用-validation-模块" tabindex="-1"><a class="header-anchor" href="#_3-如果正在使用-validation-模块"><span>3. 如果正在使用 Validation 模块</span></a></h3><p>检查是否在校验数据失败的情况下依然尝试读取绑定值，如果有，需优化逻辑，因为该值升级后为空，详见：<a href="#validation-%E5%A6%82%E6%9E%9C%E9%AA%8C%E8%AF%81%E5%A4%B1%E8%B4%A5%E5%B0%86%E4%B8%8D%E7%BB%91%E5%AE%9A%E6%95%B0%E6%8D%AE">Validation 如果验证失败将不绑定数据</a></p><h3 id="_4-如果正在使用-testing-模块" tabindex="-1"><a class="header-anchor" href="#_4-如果正在使用-testing-模块"><span>4. 如果正在使用 Testing 模块</span></a></h3><p>检查是否使用 <code>Clear</code>, <code>Image</code> 方法，如果有，需相应修改：<a href="#testing-%E6%A8%A1%E5%9D%97%E6%96%B0%E5%A2%9E%E3%80%81%E4%BF%AE%E6%94%B9%E6%96%B9%E6%B3%95">Testing 模块新增、修改方法</a></p><h3 id="_5-如果正在使用-mail-模块" tabindex="-1"><a class="header-anchor" href="#_5-如果正在使用-mail-模块"><span>5. 如果正在使用 Mail 模块</span></a></h3><p>检查是否使用 <code>Queue</code> 方法，如果有，需相应修改：<a href="#%E4%BC%98%E5%8C%96-mail-%E6%A8%A1%E5%9D%97%E7%9A%84-queue-%E6%96%B9%E6%B3%95">优化 Mail 模块的 Queue 方法</a></p><h3 id="_6-如果正在使用-auth-模块" tabindex="-1"><a class="header-anchor" href="#_6-如果正在使用-auth-模块"><span>6. 如果正在使用 Auth 模块</span></a></h3><p>需相应修改：<a href="#%E4%BC%98%E5%8C%96-auth-%E6%A8%A1%E5%9D%97-ctx-%E7%9A%84%E8%AE%BE%E7%BD%AE%E6%96%B9%E6%B3%95">优化 Auth 模块 ctx 的设置方法</a></p><h3 id="_7-如果正在使用-mock-facades" tabindex="-1"><a class="header-anchor" href="#_7-如果正在使用-mock-facades"><span>7. 如果正在使用 mock facades</span></a></h3><p>需相应修改：<a href="#%E4%BC%98%E5%8C%96-mock-facades-%E7%9A%84%E6%96%B9%E5%BC%8F">优化 mock facades 的方式</a></p><h3 id="_8-如果正在使用框架-orm-model-并且直接通过接口返回数据" tabindex="-1"><a class="header-anchor" href="#_8-如果正在使用框架-orm-model-并且直接通过接口返回数据"><span>8. 如果正在使用框架 Orm model 并且直接通过接口返回数据</span></a></h3><p>需相应修改：<a href="#%E6%A1%86%E6%9E%B6-orm-model-%E6%96%B0%E5%A2%9E-json-tag">框架 Orm model 新增 json tag</a></p><h2 id="功能介绍" tabindex="-1"><a class="header-anchor" href="#功能介绍"><span>功能介绍</span></a></h2><h3 id="本地化" tabindex="-1"><a class="header-anchor" href="#本地化"><span>本地化</span></a></h3><p>Version: v1.14.0</p>`,51)),n("p",null,[l(e,{to:"/zh/digging-deeper/localization.html"},{default:i(()=>s[0]||(s[0]=[a("查看文档")])),_:1})]),s[24]||(s[24]=t('<h3 id="安装器" tabindex="-1"><a class="header-anchor" href="#安装器"><span>安装器</span></a></h3><p>Version: v1.14.0</p><p>通过安装器，你可以很方便的下载并初始化一个新的 Goravel 项目。</p><p><a href="http://github.com/goravel/installer" target="_blank" rel="noopener noreferrer">查看文档</a></p><h3 id="cookie" tabindex="-1"><a class="header-anchor" href="#cookie"><span>Cookie</span></a></h3><p>Version: v1.14.0</p>',6)),n("p",null,[l(e,{to:"/zh/the-basics/request.html#cookie"},{default:i(()=>s[1]||(s[1]=[a("查看 Request 文档")])),_:1})]),n("p",null,[l(e,{to:"/zh/the-basics/response.html#cookie"},{default:i(()=>s[2]||(s[2]=[a("查看 Response 文档")])),_:1})]),s[25]||(s[25]=n("h3",{id:"session",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#session"},[n("span",null,"Session")])],-1)),s[26]||(s[26]=n("p",null,"Version: v1.14.0",-1)),n("p",null,[l(e,{to:"/zh/the-basics/session.html"},{default:i(()=>s[3]||(s[3]=[a("查看文档")])),_:1})]),s[27]||(s[27]=t('<h3 id="gin-和-fiber-驱动支持设置-body-limit-和-header-limit" tabindex="-1"><a class="header-anchor" href="#gin-和-fiber-驱动支持设置-body-limit-和-header-limit"><span>gin 和 fiber 驱动支持设置 body_limit 和 header_limit</span></a></h3><p>Version: v1.14.0</p><p>HTTP 驱动支持设置 <code>body_limit</code> 和 <code>header_limit</code> 以限制 <code>body</code>, <code>header</code> 大小，详见：<a href="https://github.com/goravel/gin/blob/c9d7706a6a04c05c8c33af5c97877a1ad2ea6362/README.md?plain=1#L54" target="_blank" rel="noopener noreferrer">goravel/gin</a> 和 <a href="https://github.com/goravel/fiber/blob/aa63ab657cd2b371fcda4df0090a41226f6c0704/README.md?plain=1#L56" target="_blank" rel="noopener noreferrer">goravel/fiber</a>。</p><h3 id="log-新增方法" tabindex="-1"><a class="header-anchor" href="#log-新增方法"><span>Log 新增方法</span></a></h3><p>Version: v1.14.0</p><table><thead><tr><th>方法</th><th>说明</th></tr></thead><tbody><tr><td><code>Stack</code></td><td>同时使用多个日志通道</td></tr><tr><td><code>Channel</code></td><td>指定日志通道</td></tr><tr><td><code>WithTrace</code></td><td>打印堆栈信息</td></tr></tbody></table>',6)),n("p",null,[l(e,{to:"/zh/the-basics/logging.html#%E5%86%99%E5%85%A5%E7%89%B9%E5%AE%9A%E9%80%9A%E9%81%93"},{default:i(()=>s[4]||(s[4]=[a("查看文档")])),_:1})]),s[28]||(s[28]=t('<h3 id="orm-新增方法" tabindex="-1"><a class="header-anchor" href="#orm-新增方法"><span>Orm 新增方法</span></a></h3><p>Version: v1.14.0</p><p>新增 <code>WhereIn</code>, <code>OrWhereIn</code>, <code>OrWhereNotIn</code>, <code>WhereNotIn</code>, <code>WhereBetween</code>, <code>WhereNotBetween</code>, <code>WhereNull</code>, <code>OrWhereNull</code>, <code>OrderByDesc</code>, <code>OrderBy</code>, <code>InRandomOrder</code>, <code>Exists</code> 方法。</p><h3 id="console-新增方法" tabindex="-1"><a class="header-anchor" href="#console-新增方法"><span>Console 新增方法</span></a></h3><p>Version: v1.14.0</p>',5)),n("p",null,[l(e,{to:"/zh/digging-deeper/artisan-console.html#%E4%BA%A4%E4%BA%92%E5%BC%8F%E8%BE%93%E5%85%A5"},{default:i(()=>s[5]||(s[5]=[a("查看文档")])),_:1})]),s[29]||(s[29]=n("h3",{id:"response-新增方法",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#response-新增方法"},[n("span",null,"Response 新增方法")])],-1)),s[30]||(s[30]=n("p",null,"Version: v1.14.0",-1)),n("p",null,[l(e,{to:"/zh/the-basics/response.html#%E7%A9%BA%E5%93%8D%E5%BA%94"},{default:i(()=>s[6]||(s[6]=[a("查看文档")])),_:1})]),s[31]||(s[31]=n("h3",{id:"新增-build-命令",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#新增-build-命令"},[n("span",null,"新增 Build 命令")])],-1)),s[32]||(s[32]=n("p",null,"Version: v1.14.0",-1)),s[33]||(s[33]=n("p",null,[a("Goravel 项目可以直接通过 "),n("code",null,"go run . artisan build"),a(" 命令进行编译。")],-1)),n("p",null,[l(e,{to:"/zh/getting-started/compile.html#%E7%BC%96%E8%AF%91%E5%91%BD%E4%BB%A4"},{default:i(()=>s[7]||(s[7]=[a("查看文档")])),_:1})]),s[34]||(s[34]=n("h3",{id:"新增-helper-方法",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#新增-helper-方法"},[n("span",null,"新增 helper 方法")])],-1)),s[35]||(s[35]=n("p",null,"Version: v1.14.0",-1)),n("ul",null,[n("li",null,[l(e,{to:"/zh/digging-deeper/strings.html"},{default:i(()=>s[8]||(s[8]=[a("Str")])),_:1})]),n("li",null,[l(e,{to:"/zh/digging-deeper/helpers.html#maps"},{default:i(()=>s[9]||(s[9]=[a("Map")])),_:1})]),n("li",null,[l(e,{to:"/zh/digging-deeper/color.html"},{default:i(()=>s[10]||(s[10]=[a("Color")])),_:1})]),n("li",null,[l(e,{to:"/zh/digging-deeper/helpers.html#convert"},{default:i(()=>s[11]||(s[11]=[a("Convert")])),_:1})]),n("li",null,[l(e,{to:"/zh/digging-deeper/helpers.html#collect"},{default:i(()=>s[12]||(s[12]=[a("Collect")])),_:1})])]),s[36]||(s[36]=t(`<h3 id="redis-驱动支持设置-tls" tabindex="-1"><a class="header-anchor" href="#redis-驱动支持设置-tls"><span>Redis 驱动支持设置 TLS</span></a></h3><p>Version: v1.14.0</p><p><a href="https://github.com/goravel/redis" target="_blank" rel="noopener noreferrer">查看文档</a></p><h3 id="validation-如果验证失败将不绑定数据" tabindex="-1"><a class="header-anchor" href="#validation-如果验证失败将不绑定数据"><span>Validation 如果验证失败将不绑定数据</span></a></h3><p>Version: v1.14.0</p><p>之前在调用下面方式时，如果验证失败 <code>userRequest</code> 依然绑定了值，升级后则不再绑定。</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">var</span> userRequest requests<span class="token punctuation">.</span>UserRequest</span>
<span class="line">errors<span class="token punctuation">,</span> err <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ValidateRequest</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>userRequest<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// or</span></span>
<span class="line">validator<span class="token punctuation">,</span> err <span class="token operator">:=</span> validation<span class="token punctuation">.</span><span class="token function">Make</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span></span>
<span class="line">err <span class="token operator">=</span> validator<span class="token punctuation">.</span><span class="token function">Bind</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>userRequest<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="testing-模块新增、修改方法" tabindex="-1"><a class="header-anchor" href="#testing-模块新增、修改方法"><span>Testing 模块新增、修改方法</span></a></h3><p>Version: v1.14.0</p>`,9)),n("ol",null,[n("li",null,[s[14]||(s[14]=a("新增 ")),l(e,{to:"/zh/testing/getting-started.html#%E9%87%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93"},{default:i(()=>s[13]||(s[13]=[a("Fresh")])),_:1}),s[15]||(s[15]=a(" 方法；"))]),n("li",null,[s[17]||(s[17]=a("修改 ")),s[18]||(s[18]=n("code",null,"Clear",-1)),s[19]||(s[19]=a(" 方法为 ")),l(e,{to:"/zh/testing/getting-started.html#%E5%8D%B8%E8%BD%BD%E9%95%9C%E5%83%8F"},{default:i(()=>s[16]||(s[16]=[a("Stop")])),_:1}),s[20]||(s[20]=a(" 方法；"))]),s[21]||(s[21]=n("li",null,[n("code",null,"Image"),a(" 方法新增 "),n("code",null,"ExposedPorts"),a(" 参数，删除 "),n("code",null,"Timeout"),a(" 参数；")],-1))]),s[37]||(s[37]=t(`<div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line">database<span class="token punctuation">,</span> err <span class="token operator">:=</span> facades<span class="token punctuation">.</span><span class="token function">Testing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Docker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Database</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">database<span class="token punctuation">.</span><span class="token function">Image</span><span class="token punctuation">(</span>testingcontract<span class="token punctuation">.</span>Image<span class="token punctuation">{</span></span>
<span class="line">  Repository<span class="token punctuation">:</span> <span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  Tag<span class="token punctuation">:</span>        <span class="token string">&quot;5.7&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  Env<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&quot;MYSQL_ROOT_PASSWORD=123123&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;MYSQL_DATABASE=goravel&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token operator">--</span> Timeout<span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token operator">++</span> ExposedPorts<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;3306&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="优化-mail-模块的-queue-方法" tabindex="-1"><a class="header-anchor" href="#优化-mail-模块的-queue-方法"><span>优化 Mail 模块的 Queue 方法</span></a></h3><p>Version: v1.14.0</p><p><code>Queue</code> 方法的入参由 <code>queue *mail.Queue</code> 改为 <code>queue ...mail.Queue</code>。</p><div class="language-diff line-numbers-mode" data-highlighter="prismjs" data-ext="diff" data-title="diff"><pre><code><span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- facades.Mail().Queue(nil)</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ facades.Mail().Queue()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- facades.Mail().Queue(&amp;mail.Queue{})</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ facades.Mail().Queue(mail.Queue{})</span>
<span class="line"></span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="优化-auth-模块-ctx-的设置方法" tabindex="-1"><a class="header-anchor" href="#优化-auth-模块-ctx-的设置方法"><span>优化 Auth 模块 ctx 的设置方法</span></a></h3><p>Version: v1.14.0</p><p>之前调用 <code>Parse</code>, <code>User</code>, <code>Login</code>, <code>LoginUsingID</code>, <code>Refresh</code>, <code>Logout</code> 方法时，需要传递 <code>ctx</code>，升级后不再需要，而是可以直接设置在 <code>facades.Auth(ctx)</code>。</p><div class="language-diff line-numbers-mode" data-highlighter="prismjs" data-ext="diff" data-title="diff"><pre><code><span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- facades.Auth().Parse(ctx, token)</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ facades.Auth(ctx).Parse(token)</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- facades.Auth().User(ctx, &amp;user)</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ facades.Auth(ctx).User(&amp;user)</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- facades.Auth().Login(ctx, &amp;user)</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ facades.Auth(ctx).Login(&amp;user)</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- facades.Auth().LoginUsingID(ctx, id)</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ facades.Auth(ctx).LoginUsingID(id)</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- facades.Auth().Refresh(ctx)</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ facades.Auth(ctx).Refresh()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- facades.Auth().Logout(ctx)</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ facades.Auth(ctx).Logout()</span>
<span class="line"></span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="优化-mock-facades-的方式" tabindex="-1"><a class="header-anchor" href="#优化-mock-facades-的方式"><span>优化 mock facades 的方式</span></a></h3><p>Version: v1.14.0</p><div class="language-diff line-numbers-mode" data-highlighter="prismjs" data-ext="diff" data-title="diff"><pre><code><span class="line">import github.com/goravel/framework/testing/mock</span>
<span class="line"></span>
<span class="line"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ mockFactory := mock.Factory()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- app := mock.App()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ app := mockFactory.App()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- artisan := mock.Artisan()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ artisan := mockFactory.Artisan()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- auth := mock.Auth()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ auth := mockFactory.Auth()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- artisan := mock.Artisan()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ artisan := mockFactory.Artisan()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- cache, driver, lock := mock.Cache()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ cache := mockFactory.Cache()</span>
<span class="line"></span><span class="token prefix inserted">+</span><span class="token line">+ driver := mockFactory.CacheDriver()</span>
<span class="line"></span><span class="token prefix inserted">+</span><span class="token line">+ lock := mockFactory.CacheLock()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- config := mock.Config()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ config := mockFactory.Config()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- crypt := mock.Crypt()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ crypt := mockFactory.Crypt()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- event, task := mock.Event()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ event := mockFactory.Event()</span>
<span class="line"></span><span class="token prefix inserted">+</span><span class="token line">+ event := mockFactory.EventTask()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- gate := mock.Gate()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ gate := mockFactory.Gate()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- grpc := mock.Grpc()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ grpc := mockFactory.Grpc()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- hash := mock.Hash()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ hash := mockFactory.Hash()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- mock.Log()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ mockFactory.Log()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- mail := mock.Mail()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ mail := mockFactory.Mail()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- orm, query, transaction, association := mock.Orm()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ orm := mockFactory.Orm()</span>
<span class="line"></span><span class="token prefix inserted">+</span><span class="token line">+ query := mockFactory.OrmQuery()</span>
<span class="line"></span><span class="token prefix inserted">+</span><span class="token line">+ transaction := mockFactory.OrmTransaction()</span>
<span class="line"></span><span class="token prefix inserted">+</span><span class="token line">+ association := mockFactory.OrmAssociation()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- queue, task := mock.Queue()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ queue := mockFactory.Queue()</span>
<span class="line"></span><span class="token prefix inserted">+</span><span class="token line">+ task := mockFactory.QueueTask()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- rateLimiter := mock.RateLimiter()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ rateLimiter := mockFactory.RateLimiter()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- storage, driver, file := mock.Storage()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ storage := mockFactory.Storage()</span>
<span class="line"></span><span class="token prefix inserted">+</span><span class="token line">+ driver := mockFactory.StorageDriver()</span>
<span class="line"></span><span class="token prefix inserted">+</span><span class="token line">+ file := mockFactory.StorageFile()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- seeder := mock.Seeder()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ seeder := mockFactory.Seeder()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- validation, validator, errors := mock.Validation()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ validation := mockFactory.Validation()</span>
<span class="line"></span><span class="token prefix inserted">+</span><span class="token line">+ validator := mockFactory.ValidationValidator()</span>
<span class="line"></span><span class="token prefix inserted">+</span><span class="token line">+ errors := mockFactory.ValidationErrors()</span>
<span class="line"></span></span></span>
<span class="line"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">- view := mock.View()</span>
<span class="line"></span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">+ view := mockFactory.View()</span>
<span class="line"></span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="框架-orm-model-新增-json-tag" tabindex="-1"><a class="header-anchor" href="#框架-orm-model-新增-json-tag"><span>框架 Orm model 新增 json tag</span></a></h3><p>Version: v1.14.0</p><p>如果使用了框架的 Orm model 并且通过接口直接返回数据，需要自己根据原 model 结构新建 model 并替换，或者前端根据 json tag 修改字段名称。</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">type</span> Model <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>
<span class="line">	<span class="token operator">--</span> ID <span class="token builtin">uint</span> <span class="token string">\`gorm:&quot;primaryKey&quot;\`</span></span>
<span class="line">	<span class="token operator">++</span> ID <span class="token builtin">uint</span> <span class="token string">\`gorm:&quot;primaryKey&quot; json:&quot;id&quot;\`</span></span>
<span class="line">	Timestamps</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">type</span> SoftDeletes <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>
<span class="line">	<span class="token operator">--</span> DeletedAt gorm<span class="token punctuation">.</span>DeletedAt <span class="token string">\`gorm:&quot;column:deleted_at&quot;\`</span></span>
<span class="line">	<span class="token operator">++</span> DeletedAt gorm<span class="token punctuation">.</span>DeletedAt <span class="token string">\`gorm:&quot;column:deleted_at&quot; json:&quot;deleted_at&quot;\`</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">type</span> Timestamps <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>
<span class="line">	<span class="token operator">--</span> CreatedAt carbon<span class="token punctuation">.</span>DateTime <span class="token string">\`gorm:&quot;autoCreateTime;column:created_at&quot;\`</span></span>
<span class="line">	<span class="token operator">--</span> UpdatedAt carbon<span class="token punctuation">.</span>DateTime <span class="token string">\`gorm:&quot;autoUpdateTime;column:updated_at&quot;\`</span></span>
<span class="line">	<span class="token operator">++</span> CreatedAt carbon<span class="token punctuation">.</span>DateTime <span class="token string">\`gorm:&quot;autoCreateTime;column:created_at&quot; json:&quot;created_at&quot;\`</span></span>
<span class="line">	<span class="token operator">++</span> UpdatedAt carbon<span class="token punctuation">.</span>DateTime <span class="token string">\`gorm:&quot;autoUpdateTime;column:updated_at&quot; json:&quot;updated_at&quot;\`</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="修复-session-在-gin-驱动中设置不成功的问题" tabindex="-1"><a class="header-anchor" href="#修复-session-在-gin-驱动中设置不成功的问题"><span>修复 session 在 gin 驱动中设置不成功的问题</span></a></h3><p>goravel/framework: v1.14.1</p><h3 id="修复本地化模块中语言文件读取错误的问题" tabindex="-1"><a class="header-anchor" href="#修复本地化模块中语言文件读取错误的问题"><span>修复本地化模块中语言文件读取错误的问题</span></a></h3><p>goravel/framework: v1.14.1</p><h3 id="修复-validation-验证-image-与-file-失败的问题" tabindex="-1"><a class="header-anchor" href="#修复-validation-验证-image-与-file-失败的问题"><span>修复 Validation 验证 image 与 file 失败的问题</span></a></h3><p>goravel/framework: v1.14.2</p><p>goravel/gin: v1.2.2</p><p>goravel/fiber: v1.2.2</p><p><a href="https://github.com/goravel/goravel/issues/450" target="_blank" rel="noopener noreferrer">Issue #450</a></p><h3 id="修复-goravel-gin-驱动设置-cookie-expires-无效的问题" tabindex="-1"><a class="header-anchor" href="#修复-goravel-gin-驱动设置-cookie-expires-无效的问题"><span>修复 goravel/gin 驱动设置 cookie Expires 无效的问题</span></a></h3><p>goravel/gin: v1.2.2</p><h3 id="修复-validation-无法绑定-slice-的问题" tabindex="-1"><a class="header-anchor" href="#修复-validation-无法绑定-slice-的问题"><span>修复 Validation 无法绑定 slice 的问题</span></a></h3><p>goravel/framework: v1.14.3</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>
<span class="line">	Tags   <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span> <span class="token string">\`form:&quot;tags&quot; json:&quot;tags&quot;\`</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="validation-支持绑定-carbon" tabindex="-1"><a class="header-anchor" href="#validation-支持绑定-carbon"><span>Validation 支持绑定 carbon</span></a></h3><p>goravel/framework: v1.14.3</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token comment">// 定义 carbon 字段</span></span>
<span class="line"><span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span></span>
<span class="line">	Date   carbon<span class="token punctuation">.</span>Carbon <span class="token string">\`form:&quot;date&quot; json:&quot;date&quot;\`</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">var</span> user requests<span class="token punctuation">.</span>User</span>
<span class="line"></span>
<span class="line"><span class="token comment">// 使用 ValidateRequest 绑定数据</span></span>
<span class="line">errors<span class="token punctuation">,</span> err <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ValidateRequest</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 或使用 Validate 绑定数据</span></span>
<span class="line">validator<span class="token punctuation">,</span> err <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Validate</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token string">&quot;date&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;required|date&quot;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">err <span class="token operator">:=</span> validator<span class="token punctuation">.</span><span class="token function">Bind</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 获取时间</span></span>
<span class="line">user<span class="token punctuation">.</span>Date<span class="token punctuation">.</span><span class="token function">ToDateTimeString</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="修复-session-并发问题" tabindex="-1"><a class="header-anchor" href="#修复-session-并发问题"><span>修复 Session 并发问题</span></a></h3><p>goravel/framework: v1.14.4</p><p>当 Session 并发过高时，可能会出现 Session 读写冲突的问题。</p><h3 id="修复-gin-设置-session-same-site-无效的问题" tabindex="-1"><a class="header-anchor" href="#修复-gin-设置-session-same-site-无效的问题"><span>修复 Gin 设置 Session same_site 无效的问题</span></a></h3><p>goravel/gin: v1.2.3</p><p><a href="https://github.com/goravel/goravel/issues/455" target="_blank" rel="noopener noreferrer">Issue #455</a></p><h3 id="route-新增-shutdown-方法" tabindex="-1"><a class="header-anchor" href="#route-新增-shutdown-方法"><span>Route 新增 Shutdown 方法</span></a></h3><p>goravel/framework: v1.14.5</p><p>goravel/gin: v1.2.4</p><p>goravel/fiber: v1.2.3</p>`,43)),n("p",null,[l(e,{to:"/zh/the-basics/routing.html#%E5%85%B3%E9%97%AD-http-https-%E6%9C%8D%E5%8A%A1%E5%99%A8"},{default:i(()=>s[22]||(s[22]=[a("查看文档")])),_:1})]),s[38]||(s[38]=t(`<h3 id="优化-http-的-ctx-withvalue-方法" tabindex="-1"><a class="header-anchor" href="#优化-http-的-ctx-withvalue-方法"><span>优化 HTTP 的 ctx.WithValue 方法</span></a></h3><p>goravel/framework: v1.14.7</p><p>goravel/gin: v1.2.5</p><p>goravel/fiber: v1.2.4</p><p><code>ctx.WithValue</code> 方法的 <code>key</code> 由仅支持 <code>string</code> 类型，改支持 <code>any</code> 类型。</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line">ctx<span class="token punctuation">.</span><span class="token function">WithValue</span><span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;world&quot;</span><span class="token punctuation">)</span></span>
<span class="line">ctx<span class="token punctuation">.</span><span class="token function">WithValue</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;hi&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">var</span> key <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line">ctx<span class="token punctuation">.</span><span class="token function">WithValue</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token string">&quot;hola&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="修复注册-listener-冲突的问题" tabindex="-1"><a class="header-anchor" href="#修复注册-listener-冲突的问题"><span>修复注册 listener 冲突的问题</span></a></h3><p>goravel/framework: v1.14.8</p><p>当多个 event 使用相同的 listener，注册时会提示 listener 冲突。</p><p><a href="https://github.com/goravel/goravel/issues/523" target="_blank" rel="noopener noreferrer">Issue #523</a></p><h3 id="修复自定义-log-驱动控制台重复打印的问题" tabindex="-1"><a class="header-anchor" href="#修复自定义-log-驱动控制台重复打印的问题"><span>修复自定义 Log 驱动控制台重复打印的问题</span></a></h3><p>goravel/framework: v1.14.9</p><p><a href="https://github.com/goravel/goravel/issues/531" target="_blank" rel="noopener noreferrer">Issue #531</a></p><h3 id="修复-http-json-request-包含多层结构时数据绑定错误的问题" tabindex="-1"><a class="header-anchor" href="#修复-http-json-request-包含多层结构时数据绑定错误的问题"><span>修复 HTTP JSON Request 包含多层结构时数据绑定错误的问题</span></a></h3><p>goravel/framework: v1.14.9</p><p><a href="https://github.com/goravel/goravel/issues/533" target="_blank" rel="noopener noreferrer">Issue #533</a></p>`,16))])}const m=p(d,[["render",u],["__file","v1.14.html.vue"]]),h=JSON.parse('{"path":"/zh/upgrade/v1.14.html","title":"从 v1.13 升级到 v1.14","lang":"zh-CN","frontmatter":{"description":"从 v1.13 升级到 v1.14 令人兴奋的新功能 🎉 本地化 安装器 Cookie Session 功能增强 🚀 gin 和 fiber 驱动支持设置 body_limit 和 header_limit Log 新增方法 Orm 新增方法 Console 新增方法 Response 新增方法 新增 Build 命令 新增 helper 方法 R...","head":[["link",{"rel":"alternate","hreflang":"en-us","href":"https://goravel.dev/upgrade/v1.14.html"}],["meta",{"property":"og:url","content":"https://goravel.dev/zh/upgrade/v1.14.html"}],["meta",{"property":"og:site_name","content":"Goravel"}],["meta",{"property":"og:title","content":"/upgrade/v1.14.html"}],["meta",{"property":"og:description","content":"从 v1.13 升级到 v1.14 令人兴奋的新功能 🎉 本地化 安装器 Cookie Session 功能增强 🚀 gin 和 fiber 驱动支持设置 body_limit 和 header_limit Log 新增方法 Orm 新增方法 Console 新增方法 Response 新增方法 新增 Build 命令 新增 helper 方法 R..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"从 v1.13 升级到 v1.14\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[]}"]]},"headers":[{"level":3,"title":"令人兴奋的新功能 🎉","slug":"令人兴奋的新功能-🎉","link":"#令人兴奋的新功能-🎉","children":[]},{"level":3,"title":"功能增强 🚀","slug":"功能增强-🚀","link":"#功能增强-🚀","children":[]},{"level":3,"title":"破坏性变化 🛠","slug":"破坏性变化-🛠","link":"#破坏性变化-🛠","children":[]},{"level":3,"title":"v1.14.1","slug":"v1-14-1","link":"#v1-14-1","children":[]},{"level":3,"title":"v1.14.2","slug":"v1-14-2","link":"#v1-14-2","children":[]},{"level":3,"title":"v1.14.3","slug":"v1-14-3","link":"#v1-14-3","children":[]},{"level":3,"title":"v1.14.4","slug":"v1-14-4","link":"#v1-14-4","children":[]},{"level":3,"title":"v1.14.5","slug":"v1-14-5","link":"#v1-14-5","children":[]},{"level":3,"title":"v1.14.7","slug":"v1-14-7","link":"#v1-14-7","children":[]},{"level":3,"title":"v1.14.8","slug":"v1-14-8","link":"#v1-14-8","children":[]},{"level":3,"title":"v1.14.9","slug":"v1-14-9","link":"#v1-14-9","children":[]},{"level":2,"title":"升级指南","slug":"升级指南","link":"#升级指南","children":[{"level":3,"title":"1. 更新依赖","slug":"_1-更新依赖","link":"#_1-更新依赖","children":[]},{"level":3,"title":"2. 新增配置项","slug":"_2-新增配置项","link":"#_2-新增配置项","children":[]},{"level":3,"title":"3. 如果正在使用 Validation 模块","slug":"_3-如果正在使用-validation-模块","link":"#_3-如果正在使用-validation-模块","children":[]},{"level":3,"title":"4. 如果正在使用 Testing 模块","slug":"_4-如果正在使用-testing-模块","link":"#_4-如果正在使用-testing-模块","children":[]},{"level":3,"title":"5. 如果正在使用 Mail 模块","slug":"_5-如果正在使用-mail-模块","link":"#_5-如果正在使用-mail-模块","children":[]},{"level":3,"title":"6. 如果正在使用 Auth 模块","slug":"_6-如果正在使用-auth-模块","link":"#_6-如果正在使用-auth-模块","children":[]},{"level":3,"title":"7. 如果正在使用 mock facades","slug":"_7-如果正在使用-mock-facades","link":"#_7-如果正在使用-mock-facades","children":[]},{"level":3,"title":"8. 如果正在使用框架 Orm model 并且直接通过接口返回数据","slug":"_8-如果正在使用框架-orm-model-并且直接通过接口返回数据","link":"#_8-如果正在使用框架-orm-model-并且直接通过接口返回数据","children":[]}]},{"level":2,"title":"功能介绍","slug":"功能介绍","link":"#功能介绍","children":[{"level":3,"title":"本地化","slug":"本地化","link":"#本地化","children":[]},{"level":3,"title":"安装器","slug":"安装器","link":"#安装器","children":[]},{"level":3,"title":"Cookie","slug":"cookie","link":"#cookie","children":[]},{"level":3,"title":"Session","slug":"session","link":"#session","children":[]},{"level":3,"title":"gin 和 fiber 驱动支持设置 body_limit 和 header_limit","slug":"gin-和-fiber-驱动支持设置-body-limit-和-header-limit","link":"#gin-和-fiber-驱动支持设置-body-limit-和-header-limit","children":[]},{"level":3,"title":"Log 新增方法","slug":"log-新增方法","link":"#log-新增方法","children":[]},{"level":3,"title":"Orm 新增方法","slug":"orm-新增方法","link":"#orm-新增方法","children":[]},{"level":3,"title":"Console 新增方法","slug":"console-新增方法","link":"#console-新增方法","children":[]},{"level":3,"title":"Response 新增方法","slug":"response-新增方法","link":"#response-新增方法","children":[]},{"level":3,"title":"新增 Build 命令","slug":"新增-build-命令","link":"#新增-build-命令","children":[]},{"level":3,"title":"新增 helper 方法","slug":"新增-helper-方法","link":"#新增-helper-方法","children":[]},{"level":3,"title":"Redis 驱动支持设置 TLS","slug":"redis-驱动支持设置-tls","link":"#redis-驱动支持设置-tls","children":[]},{"level":3,"title":"Validation 如果验证失败将不绑定数据","slug":"validation-如果验证失败将不绑定数据","link":"#validation-如果验证失败将不绑定数据","children":[]},{"level":3,"title":"Testing 模块新增、修改方法","slug":"testing-模块新增、修改方法","link":"#testing-模块新增、修改方法","children":[]},{"level":3,"title":"优化 Mail 模块的 Queue 方法","slug":"优化-mail-模块的-queue-方法","link":"#优化-mail-模块的-queue-方法","children":[]},{"level":3,"title":"优化 Auth 模块 ctx 的设置方法","slug":"优化-auth-模块-ctx-的设置方法","link":"#优化-auth-模块-ctx-的设置方法","children":[]},{"level":3,"title":"优化 mock facades 的方式","slug":"优化-mock-facades-的方式","link":"#优化-mock-facades-的方式","children":[]},{"level":3,"title":"框架 Orm model 新增 json tag","slug":"框架-orm-model-新增-json-tag","link":"#框架-orm-model-新增-json-tag","children":[]},{"level":3,"title":"修复 session 在 gin 驱动中设置不成功的问题","slug":"修复-session-在-gin-驱动中设置不成功的问题","link":"#修复-session-在-gin-驱动中设置不成功的问题","children":[]},{"level":3,"title":"修复本地化模块中语言文件读取错误的问题","slug":"修复本地化模块中语言文件读取错误的问题","link":"#修复本地化模块中语言文件读取错误的问题","children":[]},{"level":3,"title":"修复 Validation 验证 image 与 file 失败的问题","slug":"修复-validation-验证-image-与-file-失败的问题","link":"#修复-validation-验证-image-与-file-失败的问题","children":[]},{"level":3,"title":"修复 goravel/gin 驱动设置 cookie Expires 无效的问题","slug":"修复-goravel-gin-驱动设置-cookie-expires-无效的问题","link":"#修复-goravel-gin-驱动设置-cookie-expires-无效的问题","children":[]},{"level":3,"title":"修复 Validation 无法绑定 slice 的问题","slug":"修复-validation-无法绑定-slice-的问题","link":"#修复-validation-无法绑定-slice-的问题","children":[]},{"level":3,"title":"Validation 支持绑定 carbon","slug":"validation-支持绑定-carbon","link":"#validation-支持绑定-carbon","children":[]},{"level":3,"title":"修复 Session 并发问题","slug":"修复-session-并发问题","link":"#修复-session-并发问题","children":[]},{"level":3,"title":"修复 Gin 设置 Session same_site 无效的问题","slug":"修复-gin-设置-session-same-site-无效的问题","link":"#修复-gin-设置-session-same-site-无效的问题","children":[]},{"level":3,"title":"Route 新增 Shutdown 方法","slug":"route-新增-shutdown-方法","link":"#route-新增-shutdown-方法","children":[]},{"level":3,"title":"优化 HTTP 的 ctx.WithValue 方法","slug":"优化-http-的-ctx-withvalue-方法","link":"#优化-http-的-ctx-withvalue-方法","children":[]},{"level":3,"title":"修复注册 listener 冲突的问题","slug":"修复注册-listener-冲突的问题","link":"#修复注册-listener-冲突的问题","children":[]},{"level":3,"title":"修复自定义 Log 驱动控制台重复打印的问题","slug":"修复自定义-log-驱动控制台重复打印的问题","link":"#修复自定义-log-驱动控制台重复打印的问题","children":[]},{"level":3,"title":"修复 HTTP JSON Request 包含多层结构时数据绑定错误的问题","slug":"修复-http-json-request-包含多层结构时数据绑定错误的问题","link":"#修复-http-json-request-包含多层结构时数据绑定错误的问题","children":[]}]}],"git":{},"filePathRelative":"zh/upgrade/v1.14.md","autoDesc":true}');export{m as comp,h as data};
