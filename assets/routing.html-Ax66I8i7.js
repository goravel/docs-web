import{_ as u,c as r,b as s,e as t,f as p,a as o,d as a,r as c,o as k}from"./app-CiuUSIOi.js";const d={},v={class:"table-of-contents"};function m(h,n){const e=c("router-link"),l=c("RouteLink"),i=c("CommentService");return k(),r("div",null,[n[23]||(n[23]=s("h1",{id:"路由",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#路由"},[s("span",null,"路由")])],-1)),s("nav",v,[s("ul",null,[s("li",null,[t(e,{to:"#简介"},{default:p(()=>n[0]||(n[0]=[a("简介")])),_:1})]),s("li",null,[t(e,{to:"#http-驱动"},{default:p(()=>n[1]||(n[1]=[a("HTTP 驱动")])),_:1})]),s("li",null,[t(e,{to:"#默认路由文件"},{default:p(()=>n[2]||(n[2]=[a("默认路由文件")])),_:1})]),s("li",null,[t(e,{to:"#启动-http-服务器"},{default:p(()=>n[3]||(n[3]=[a("启动 HTTP 服务器")])),_:1})]),s("li",null,[t(e,{to:"#启动-https-服务器"},{default:p(()=>n[4]||(n[4]=[a("启动 HTTPS 服务器")])),_:1})]),s("li",null,[t(e,{to:"#关闭-http-https-服务器"},{default:p(()=>n[5]||(n[5]=[a("关闭 HTTP/HTTPS 服务器")])),_:1}),s("ul",null,[s("li",null,[t(e,{to:"#路由方法"},{default:p(()=>n[6]||(n[6]=[a("路由方法")])),_:1})])])]),s("li",null,[t(e,{to:"#基本路由"},{default:p(()=>n[7]||(n[7]=[a("基本路由")])),_:1})]),s("li",null,[t(e,{to:"#资源路由"},{default:p(()=>n[8]||(n[8]=[a("资源路由")])),_:1})]),s("li",null,[t(e,{to:"#路由分组"},{default:p(()=>n[9]||(n[9]=[a("路由分组")])),_:1})]),s("li",null,[t(e,{to:"#路由前缀"},{default:p(()=>n[10]||(n[10]=[a("路由前缀")])),_:1})]),s("li",null,[t(e,{to:"#文件路由"},{default:p(()=>n[11]||(n[11]=[a("文件路由")])),_:1})]),s("li",null,[t(e,{to:"#路由传参"},{default:p(()=>n[12]||(n[12]=[a("路由传参")])),_:1})]),s("li",null,[t(e,{to:"#中间件"},{default:p(()=>n[13]||(n[13]=[a("中间件")])),_:1})]),s("li",null,[t(e,{to:"#fallback-路由"},{default:p(()=>n[14]||(n[14]=[a("Fallback 路由")])),_:1})]),s("li",null,[t(e,{to:"#速率限制"},{default:p(()=>n[15]||(n[15]=[a("速率限制")])),_:1}),s("ul",null,[s("li",null,[t(e,{to:"#定义速率限制器"},{default:p(()=>n[16]||(n[16]=[a("定义速率限制器")])),_:1})]),s("li",null,[t(e,{to:"#将速率限制器附加到路由"},{default:p(()=>n[17]||(n[17]=[a("将速率限制器附加到路由")])),_:1})])])]),s("li",null,[t(e,{to:"#跨域资源共享-cors"},{default:p(()=>n[18]||(n[18]=[a("跨域资源共享 (CORS)")])),_:1})])])]),n[24]||(n[24]=o(`<h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介"><span>简介</span></a></h2><p>Goravel 路由模块可以使用 <code>facades.Route()</code> 进行操作。</p><h2 id="http-驱动" tabindex="-1"><a class="header-anchor" href="#http-驱动"><span>HTTP 驱动</span></a></h2><p>Goravel 默认使用 <a href="https://github.com/gin-gonic/gin" target="_blank" rel="noopener noreferrer">gin</a> 作为 HTTP 驱动，如果想使用其他驱动，可以到 <code>config/http.go</code> 中进行配置，目前官方默认支持 <a href="https://github.com/gin-gonic/gin" target="_blank" rel="noopener noreferrer">gin</a> 与 <a href="https://github.com/gofiber/fiber" target="_blank" rel="noopener noreferrer">fiber</a> 两种驱动：</p><table><thead><tr><th>驱动</th><th>地址</th></tr></thead><tbody><tr><td>Gin</td><td><a href="https://github.com/goravel/gin" target="_blank" rel="noopener noreferrer">https://github.com/goravel/gin</a></td></tr><tr><td>Fiber</td><td><a href="https://github.com/goravel/fiber" target="_blank" rel="noopener noreferrer">https://github.com/goravel/fiber</a></td></tr></tbody></table><h2 id="默认路由文件" tabindex="-1"><a class="header-anchor" href="#默认路由文件"><span>默认路由文件</span></a></h2><p>所有路由文件都在 <code>/routes</code> 目录中进行定义。框架默认有一个示例路由 <code>/routes/web.go</code>，其中 <code>func Web()</code> 方法被注册到 <code>app/providers/route_service_provider.go</code> 文件中，以实现路由的绑定。</p><p>你可以在 <code>routes</code> 目录下新增路由文件，以进行更细颗粒的管理，然后在 <code>app/providers/route_service_provider.go</code> 文件中进行注册。</p><h2 id="启动-http-服务器" tabindex="-1"><a class="header-anchor" href="#启动-http-服务器"><span>启动 HTTP 服务器</span></a></h2><p>在根目录下 <code>main.go</code> 中启动 HTTP 服务器，<code>facades.Route().Run()</code> 将会自动获取 <code>route.host</code> 的配置。</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">package</span> main</span>
<span class="line"></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">(</span></span>
<span class="line">  <span class="token string">&quot;github.com/goravel/framework/facades&quot;</span></span>
<span class="line"></span>
<span class="line">  <span class="token string">&quot;goravel/bootstrap&quot;</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// This bootstraps the framework and gets it ready for use.</span></span>
<span class="line">  bootstrap<span class="token punctuation">.</span><span class="token function">Boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">  <span class="token comment">// Start http server by facades.Route().</span></span>
<span class="line">  <span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> err <span class="token operator">:=</span> facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">      facades<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Route run error: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">select</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="启动-https-服务器" tabindex="-1"><a class="header-anchor" href="#启动-https-服务器"><span>启动 HTTPS 服务器</span></a></h2><p>使用前请先完善 <code>config/http.go</code> 中的 <code>http.tls</code> 配置，<code>facades.Route().RunTLS()</code> 方法将会根据相关配置启动 HTTPS 服务：</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token comment">// main.go</span></span>
<span class="line"><span class="token keyword">if</span> err <span class="token operator">:=</span> facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">RunTLS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">  facades<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Route run error: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>你也可以使用 <code>facades.Route().RunTLSWithCert()</code> 方法，自定义 host 与 证书：</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token comment">// main.go</span></span>
<span class="line"><span class="token keyword">if</span> err <span class="token operator">:=</span> facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">RunTLSWithCert</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1:3000&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ca.pem&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ca.key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">  facades<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Route run error: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="关闭-http-https-服务器" tabindex="-1"><a class="header-anchor" href="#关闭-http-https-服务器"><span>关闭 HTTP/HTTPS 服务器</span></a></h2><p>你可以调用 <code>Shutdown</code> 方法优雅的关闭 HTTP/HTTPS 服务器，该方法将会等待所有请求处理完毕后再执行关闭操作。</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token comment">// main.go</span></span>
<span class="line">bootstrap<span class="token punctuation">.</span><span class="token function">Boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Create a channel to listen for OS signals</span></span>
<span class="line">quit <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> os<span class="token punctuation">.</span>Signal<span class="token punctuation">)</span></span>
<span class="line">signal<span class="token punctuation">.</span><span class="token function">Notify</span><span class="token punctuation">(</span>quit<span class="token punctuation">,</span> syscall<span class="token punctuation">.</span>SIGINT<span class="token punctuation">,</span> syscall<span class="token punctuation">.</span>SIGTERM<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Start http server by facades.Route().</span></span>
<span class="line"><span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> err <span class="token operator">:=</span> facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">    facades<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Route run error: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Listen for the OS signal</span></span>
<span class="line"><span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token operator">&lt;-</span>quit</span>
<span class="line">  <span class="token keyword">if</span> err <span class="token operator">:=</span> facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">    facades<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;Route shutdown error: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">select</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="路由方法" tabindex="-1"><a class="header-anchor" href="#路由方法"><span>路由方法</span></a></h3><table><thead><tr><th>方法</th><th>作用</th></tr></thead><tbody><tr><td>Group</td><td><a href="#%E8%B7%AF%E7%94%B1%E5%88%86%E7%BB%84">路由分组</a></td></tr><tr><td>Prefix</td><td><a href="#%E8%B7%AF%E7%94%B1%E5%89%8D%E7%BC%80">路由前缀</a></td></tr><tr><td>ServeHTTP</td><td><a href="#%E6%B5%8B%E8%AF%95%E8%B7%AF%E7%94%B1">测试路由</a></td></tr><tr><td>Get</td><td><a href="#%E5%9F%BA%E6%9C%AC%E8%B7%AF%E7%94%B1">基本路由</a></td></tr><tr><td>Post</td><td><a href="#%E5%9F%BA%E6%9C%AC%E8%B7%AF%E7%94%B1">基本路由</a></td></tr><tr><td>Put</td><td><a href="#%E5%9F%BA%E6%9C%AC%E8%B7%AF%E7%94%B1">基本路由</a></td></tr><tr><td>Delete</td><td><a href="#%E5%9F%BA%E6%9C%AC%E8%B7%AF%E7%94%B1">基本路由</a></td></tr><tr><td>Patch</td><td><a href="#%E5%9F%BA%E6%9C%AC%E8%B7%AF%E7%94%B1">基本路由</a></td></tr><tr><td>Options</td><td><a href="#%E5%9F%BA%E6%9C%AC%E8%B7%AF%E7%94%B1">基本路由</a></td></tr><tr><td>Any</td><td><a href="#%E5%9F%BA%E6%9C%AC%E8%B7%AF%E7%94%B1">基本路由</a></td></tr><tr><td>Resource</td><td><a href="#%E8%B5%84%E6%BA%90%E8%B7%AF%E7%94%B1">资源路由</a></td></tr><tr><td>Static</td><td><a href="#%E6%96%87%E4%BB%B6%E8%B7%AF%E7%94%B1">文件路由</a></td></tr><tr><td>StaticFile</td><td><a href="#%E6%96%87%E4%BB%B6%E8%B7%AF%E7%94%B1">文件路由</a></td></tr><tr><td>StaticFS</td><td><a href="#%E6%96%87%E4%BB%B6%E8%B7%AF%E7%94%B1">文件路由</a></td></tr><tr><td>Middleware</td><td><a href="#%E4%B8%AD%E9%97%B4%E4%BB%B6">中间件</a></td></tr></tbody></table><h2 id="基本路由" tabindex="-1"><a class="header-anchor" href="#基本路由"><span>基本路由</span></a></h2><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line">facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx http<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> http<span class="token punctuation">.</span>Response <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> ctx<span class="token punctuation">.</span><span class="token function">Response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Json</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">,</span> http<span class="token punctuation">.</span>Json<span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Goravel&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> userController<span class="token punctuation">.</span>Show<span class="token punctuation">)</span></span>
<span class="line">facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Put</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> userController<span class="token punctuation">.</span>Show<span class="token punctuation">)</span></span>
<span class="line">facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> userController<span class="token punctuation">.</span>Show<span class="token punctuation">)</span></span>
<span class="line">facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Patch</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> userController<span class="token punctuation">.</span>Show<span class="token punctuation">)</span></span>
<span class="line">facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Options</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> userController<span class="token punctuation">.</span>Show<span class="token punctuation">)</span></span>
<span class="line">facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Any</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> userController<span class="token punctuation">.</span>Show<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="资源路由" tabindex="-1"><a class="header-anchor" href="#资源路由"><span>资源路由</span></a></h2><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token string">&quot;github.com/goravel/framework/contracts/http&quot;</span></span>
<span class="line"></span>
<span class="line">resourceController <span class="token operator">:=</span> <span class="token function">NewResourceController</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Resource</span><span class="token punctuation">(</span><span class="token string">&quot;/resource&quot;</span><span class="token punctuation">,</span> resourceController<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">type</span> ResourceController <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">func</span> NewResourceController <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>ResourceController <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token operator">&amp;</span>ResourceController<span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">// GET /resource</span></span>
<span class="line"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>ResourceController<span class="token punctuation">)</span> <span class="token function">Index</span><span class="token punctuation">(</span>ctx http<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">// GET /resource/{id}</span></span>
<span class="line"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>ResourceController<span class="token punctuation">)</span> <span class="token function">Show</span><span class="token punctuation">(</span>ctx http<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">// POST /resource</span></span>
<span class="line"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>ResourceController<span class="token punctuation">)</span> <span class="token function">Store</span><span class="token punctuation">(</span>ctx http<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">// PUT /resource/{id}</span></span>
<span class="line"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>ResourceController<span class="token punctuation">)</span> <span class="token function">Update</span><span class="token punctuation">(</span>ctx http<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">// DELETE /resource/{id}</span></span>
<span class="line"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>ResourceController<span class="token punctuation">)</span> <span class="token function">Destroy</span><span class="token punctuation">(</span>ctx http<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="路由分组" tabindex="-1"><a class="header-anchor" href="#路由分组"><span>路由分组</span></a></h2><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line">facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>router route<span class="token punctuation">.</span>Router<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  router<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;group/{id}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx http<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> http<span class="token punctuation">.</span>Response <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> ctx<span class="token punctuation">.</span><span class="token function">Response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Query</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="路由前缀" tabindex="-1"><a class="header-anchor" href="#路由前缀"><span>路由前缀</span></a></h2><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line">facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Prefix</span><span class="token punctuation">(</span><span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> userController<span class="token punctuation">.</span>Show<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="文件路由" tabindex="-1"><a class="header-anchor" href="#文件路由"><span>文件路由</span></a></h2><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token string">&quot;net/http&quot;</span></span>
<span class="line"></span>
<span class="line">facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Static</span><span class="token punctuation">(</span><span class="token string">&quot;static&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./public&quot;</span><span class="token punctuation">)</span></span>
<span class="line">facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">StaticFile</span><span class="token punctuation">(</span><span class="token string">&quot;static-file&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./public/logo.png&quot;</span><span class="token punctuation">)</span></span>
<span class="line">facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">StaticFS</span><span class="token punctuation">(</span><span class="token string">&quot;static-fs&quot;</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span><span class="token function">Dir</span><span class="token punctuation">(</span><span class="token string">&quot;./public&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="路由传参" tabindex="-1"><a class="header-anchor" href="#路由传参"><span>路由传参</span></a></h2><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line">facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/input/{id}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx http<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> http<span class="token punctuation">.</span>Response <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> ctx<span class="token punctuation">.</span><span class="token function">Response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Json</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>Json<span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> ctx<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Input</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,33)),s("p",null,[n[20]||(n[20]=a("详见")),t(l,{to:"/zh/the-basics/request.html"},{default:p(()=>n[19]||(n[19]=[a("请求")])),_:1})]),n[25]||(n[25]=o(`<h2 id="中间件" tabindex="-1"><a class="header-anchor" href="#中间件"><span>中间件</span></a></h2><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token string">&quot;github.com/goravel/framework/http/middleware&quot;</span></span>
<span class="line"></span>
<span class="line">facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Middleware</span><span class="token punctuation">(</span>middleware<span class="token punctuation">.</span><span class="token function">Cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;users&quot;</span><span class="token punctuation">,</span> userController<span class="token punctuation">.</span>Show<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2)),s("p",null,[n[22]||(n[22]=a("详见")),t(l,{to:"/zh/the-basics/middleware.html"},{default:p(()=>n[21]||(n[21]=[a("中间件")])),_:1})]),n[26]||(n[26]=o(`<h2 id="fallback-路由" tabindex="-1"><a class="header-anchor" href="#fallback-路由"><span>Fallback 路由</span></a></h2><p>使用 <code>Fallback</code> 方法，你可以定义一个在没有其他路由匹配传入请求时将执行的路由。</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line">facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Fallback</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>ctx http<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> http<span class="token punctuation">.</span>Response <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> ctx<span class="token punctuation">.</span><span class="token function">Response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">,</span> <span class="token string">&quot;not found&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="速率限制" tabindex="-1"><a class="header-anchor" href="#速率限制"><span>速率限制</span></a></h2><h3 id="定义速率限制器" tabindex="-1"><a class="header-anchor" href="#定义速率限制器"><span>定义速率限制器</span></a></h3><p>Goravel 包含强大且可自定义的速率限制服务，你可以利用这些服务来限制给定路由或一组路由的流量。首先，你应该定义满足应用程序需求的速率限制器配置。通常，这应该在应用程序的 <code>app/providers/route_service_provider.go</code> 文件的 <code>configureRateLimiting</code> 方法中完成。</p><p>速率限制器使用 <code>facades.RateLimiter()</code> 的 <code>For</code> 方法进行定义。<code>For</code> 方法接受一个速率限制器名称和一个闭包，该闭包返回应该应用于分配给速率限制器的路由的限制配置。速率限制器名称可以是你希望的任何字符串：</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">(</span></span>
<span class="line">  contractshttp <span class="token string">&quot;github.com/goravel/framework/contracts/http&quot;</span></span>
<span class="line">  <span class="token string">&quot;github.com/goravel/framework/facades&quot;</span></span>
<span class="line">  <span class="token string">&quot;github.com/goravel/framework/http/limit&quot;</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">func</span> <span class="token punctuation">(</span>receiver <span class="token operator">*</span>RouteServiceProvider<span class="token punctuation">)</span> <span class="token function">configureRateLimiting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  facades<span class="token punctuation">.</span><span class="token function">RateLimiter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">For</span><span class="token punctuation">(</span><span class="token string">&quot;global&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx contractshttp<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> contractshttp<span class="token punctuation">.</span>Limit <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> limit<span class="token punctuation">.</span><span class="token function">PerMinute</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果传入的请求超过指定的速率限制，Goravel 将自动返回一个带有 429 HTTP 状态码的响应。如果你想定义自己的响应，应该由速率限制返回，你可以使用 <code>Response</code> 方法：</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line">facades<span class="token punctuation">.</span><span class="token function">RateLimiter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">For</span><span class="token punctuation">(</span><span class="token string">&quot;global&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx http<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> http<span class="token punctuation">.</span>Limit <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> limit<span class="token punctuation">.</span><span class="token function">PerMinute</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Response</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>ctx http<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    ctx<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">AbortWithStatus</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusTooManyRequests<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>由于速率限制器回调接收传入的 HTTP 请求实例，你可以根据传入的请求或经过身份验证的用户动态构建适当的速率限制：</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line">facades<span class="token punctuation">.</span><span class="token function">RateLimiter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">For</span><span class="token punctuation">(</span><span class="token string">&quot;global&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx contractshttp<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> contractshttp<span class="token punctuation">.</span>Limit <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// 假设</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token function">is_vip</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> limit<span class="token punctuation">.</span><span class="token function">PerMinute</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">return</span> <span class="token boolean">nil</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="分段速率限制" tabindex="-1"><a class="header-anchor" href="#分段速率限制"><span>分段速率限制</span></a></h4><p>有时你可能希望按某个任意值对速率限制进行分段。例如，你可能希望每个 IP 地址每分钟允许用户访问给定路由 100 次。为此，你可以在构建速率限制时使用 <code>By</code> 方法：</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line">facades<span class="token punctuation">.</span><span class="token function">RateLimiter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">For</span><span class="token punctuation">(</span><span class="token string">&quot;global&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx contractshttp<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> contractshttp<span class="token punctuation">.</span>Limit <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token function">is_vip</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> limit<span class="token punctuation">.</span><span class="token function">PerMinute</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">By</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Ip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">return</span> <span class="token boolean">nil</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>为了使用另一个示例来说明此功能，我们可以将每个经过身份验证的用户 ID 的路由访问限制为每分钟 100 次，或者对于访客来说，每个 IP 地址每分钟访问 10 次：</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line">facades<span class="token punctuation">.</span><span class="token function">RateLimiter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">For</span><span class="token punctuation">(</span><span class="token string">&quot;global&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx contractshttp<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> contractshttp<span class="token punctuation">.</span>Limit <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> userID <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> limit<span class="token punctuation">.</span><span class="token function">PerMinute</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">By</span><span class="token punctuation">(</span>userID<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">return</span> limit<span class="token punctuation">.</span><span class="token function">PerMinute</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">By</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Ip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="多个速率限制" tabindex="-1"><a class="header-anchor" href="#多个速率限制"><span>多个速率限制</span></a></h4><p>如果需要，你可以返回给定速率限制器配置的速率限制数组。将根据路由在数组中的放置顺序评估每个速率限制：</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line">facades<span class="token punctuation">.</span><span class="token function">RateLimiter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ForWithLimits</span><span class="token punctuation">(</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx contractshttp<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>contractshttp<span class="token punctuation">.</span>Limit <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>contractshttp<span class="token punctuation">.</span>Limit<span class="token punctuation">{</span></span>
<span class="line">    limit<span class="token punctuation">.</span><span class="token function">PerMinute</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    limit<span class="token punctuation">.</span><span class="token function">PerMinute</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">By</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Ip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="将速率限制器附加到路由" tabindex="-1"><a class="header-anchor" href="#将速率限制器附加到路由"><span>将速率限制器附加到路由</span></a></h3><p>可以使用 <code>Throttle</code> middleware 将速率限制器附加到路由或路由组。路由中间件接受你希望分配给路由的速率限制器的名称：</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">import</span> github<span class="token punctuation">.</span>com<span class="token operator">/</span>goravel<span class="token operator">/</span>framework<span class="token operator">/</span>http<span class="token operator">/</span>middleware</span>
<span class="line"></span>
<span class="line">facades<span class="token punctuation">.</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Middleware</span><span class="token punctuation">(</span>middleware<span class="token punctuation">.</span><span class="token function">Throttle</span><span class="token punctuation">(</span><span class="token string">&quot;global&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx http<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> http<span class="token punctuation">.</span>Response <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> ctx<span class="token punctuation">.</span><span class="token function">Response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Json</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span>Json<span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Goravel&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="跨域资源共享-cors" tabindex="-1"><a class="header-anchor" href="#跨域资源共享-cors"><span>跨域资源共享 (CORS)</span></a></h2><p>Goravel 已默认启用 CORS，详细配置可以到 <code>config/cors.go</code> 文件中进行修改。</p><blockquote><p>有关 CORS 和 CORS 标头的更多信息，请参阅 <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#The_HTTP_response_headers" target="_blank" rel="noopener noreferrer">MDN 关于 CORS 的 Web 文档</a>。</p></blockquote>`,26)),t(i)])}const f=u(d,[["render",m],["__file","routing.html.vue"]]),g=JSON.parse('{"path":"/zh/the-basics/routing.html","title":"路由","lang":"zh-CN","frontmatter":{"description":"路由 简介 Goravel 路由模块可以使用 facades.Route() 进行操作。 HTTP 驱动 Goravel 默认使用 gin 作为 HTTP 驱动，如果想使用其他驱动，可以到 config/http.go 中进行配置，目前官方默认支持 gin 与 fiber 两种驱动： 默认路由文件 所有路由文件都在 /routes 目录中进行定义。框架...","head":[["link",{"rel":"alternate","hreflang":"en-us","href":"https://goravel.dev/the-basics/routing.html"}],["meta",{"property":"og:url","content":"https://goravel.dev/zh/the-basics/routing.html"}],["meta",{"property":"og:site_name","content":"Goravel"}],["meta",{"property":"og:title","content":"/the-basics/routing.html"}],["meta",{"property":"og:description","content":"路由 简介 Goravel 路由模块可以使用 facades.Route() 进行操作。 HTTP 驱动 Goravel 默认使用 gin 作为 HTTP 驱动，如果想使用其他驱动，可以到 config/http.go 中进行配置，目前官方默认支持 gin 与 fiber 两种驱动： 默认路由文件 所有路由文件都在 /routes 目录中进行定义。框架..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"路由\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[]}"]]},"headers":[{"level":2,"title":"简介","slug":"简介","link":"#简介","children":[]},{"level":2,"title":"HTTP 驱动","slug":"http-驱动","link":"#http-驱动","children":[]},{"level":2,"title":"默认路由文件","slug":"默认路由文件","link":"#默认路由文件","children":[]},{"level":2,"title":"启动 HTTP 服务器","slug":"启动-http-服务器","link":"#启动-http-服务器","children":[]},{"level":2,"title":"启动 HTTPS 服务器","slug":"启动-https-服务器","link":"#启动-https-服务器","children":[]},{"level":2,"title":"关闭 HTTP/HTTPS 服务器","slug":"关闭-http-https-服务器","link":"#关闭-http-https-服务器","children":[{"level":3,"title":"路由方法","slug":"路由方法","link":"#路由方法","children":[]}]},{"level":2,"title":"基本路由","slug":"基本路由","link":"#基本路由","children":[]},{"level":2,"title":"资源路由","slug":"资源路由","link":"#资源路由","children":[]},{"level":2,"title":"路由分组","slug":"路由分组","link":"#路由分组","children":[]},{"level":2,"title":"路由前缀","slug":"路由前缀","link":"#路由前缀","children":[]},{"level":2,"title":"文件路由","slug":"文件路由","link":"#文件路由","children":[]},{"level":2,"title":"路由传参","slug":"路由传参","link":"#路由传参","children":[]},{"level":2,"title":"中间件","slug":"中间件","link":"#中间件","children":[]},{"level":2,"title":"Fallback 路由","slug":"fallback-路由","link":"#fallback-路由","children":[]},{"level":2,"title":"速率限制","slug":"速率限制","link":"#速率限制","children":[{"level":3,"title":"定义速率限制器","slug":"定义速率限制器","link":"#定义速率限制器","children":[]},{"level":3,"title":"将速率限制器附加到路由","slug":"将速率限制器附加到路由","link":"#将速率限制器附加到路由","children":[]}]},{"level":2,"title":"跨域资源共享 (CORS)","slug":"跨域资源共享-cors","link":"#跨域资源共享-cors","children":[]}],"git":{},"filePathRelative":"zh/the-basics/routing.md","autoDesc":true}');export{f as comp,g as data};
