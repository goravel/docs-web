import{_ as o,r,o as d,c as l,b as e,d as a,w as n,e as t,f as c}from"./app.2ddb10a7.js";const u={},m=e("h1",{id:"migrations",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#migrations","aria-hidden":"true"},"#"),t(" Migrations")],-1),h={class:"table-of-contents"},_=t("Introduction"),g=t("Create Migrations"),p=t("Quickly Create"),v=e("h2",{id:"introduction",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#introduction","aria-hidden":"true"},"#"),t(" Introduction")],-1),b=e("p",null,"When multiple people collaborate to develop applications, if there is no unified specification for the synchronization database structure to ensure that everyone's local data is consistent, it will be a disaster. Database migration is to solve this problem. The database structure is version controlled to ensure the consistency of the database structure of all developers.",-1),f=t("Goravel's data migration function is supported by the well-known "),x={href:"https://github.com/golang-migrate/migrate",target:"_blank",rel:"noopener noreferrer"},E=t("golang-migrate/migrate"),T=t("."),w=c(`<h2 id="create-migrations" tabindex="-1"><a class="header-anchor" href="#create-migrations" aria-hidden="true">#</a> Create Migrations</h2><p>Use the <code>make:migration</code> command to create the migration: <code>go run . artisan make:migration create_users_table</code></p><p>This command will generate migration files in the <code>database/migrations</code> directory. All migration files start with a timestamp. Goravel will use this as the execution order of the migration files. All migration files are <code>.sql</code> files, and you can customize the table structure using SQL statements.</p><p>The migration command will generate two migration files at the same time: <code>***.up.sql</code> and <code>***.down.sql</code>, respectively corresponding to execution and rollback. (The rollback function will be supported in future versions)</p><h2 id="quickly-create" tabindex="-1"><a class="header-anchor" href="#quickly-create" aria-hidden="true">#</a> Quickly Create</h2><p>Using <code>craete_users_table</code> will automatically generate a table containing the infrastructure of <code>users</code>:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>CREATE TABLE users (
  id bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  created_at datetime(3) DEFAULT NULL,
  updated_at datetime(3) DEFAULT NULL,
  PRIMARY KEY (id),
  KEY idx_users_created_at (created_at),
  KEY idx_users_updated_at (updated_at)
) ENGINE = InnoDB AUTO_INCREMENT = 1 DEFAULT CHARSET = DummyDatabaseCharset;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The realization principle is to match according to the regularity:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>^create_(\\w+)_table$
^create_(\\w+)$
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Using <code>add_avatar_to_users_table</code> will automatically generate a structure for adding fields to the <code>users</code> table:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>ALTER TABLE users ADD column varchar(255) COMMENT &#39;&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>The realization principle is to match according to the regularity:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>_(to|from|in)_(\\w+)_table$
_(to|from|in)_(\\w+)$
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>When the above conditions are not matched, the framework will generate an empty migration file.</p>`,14);function k(y,L){const i=r("router-link"),s=r("ExternalLinkIcon");return d(),l("div",null,[m,e("nav",h,[e("ul",null,[e("li",null,[a(i,{to:"#introduction"},{default:n(()=>[_]),_:1})]),e("li",null,[a(i,{to:"#create-migrations"},{default:n(()=>[g]),_:1})]),e("li",null,[a(i,{to:"#quickly-create"},{default:n(()=>[p]),_:1})])])]),v,b,e("p",null,[f,e("a",x,[E,a(s)]),T]),w])}const A=o(u,[["render",k],["__file","migrations.html.vue"]]);export{A as default};
